<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Medicine</title>
	<link rel="stylesheet" href="c.css">
	
</head>
<body>
    <div class="Register-box">
		<h1>Register Medicine</h1>
        <div class="textbox">
			<i class="fas fa-barcode"></i>
			<input type="text" placeholder="Barcode" id="Mid">
			        
		</div>
        
        <div class="textbox">
			<i class="fas fa-pills"></i>
			<input type="text" placeholder="Medicine Name" id="Mname">
        </div>

        <div class="textbox">
			<i class="fas fa-file-signature"></i>
            <input type="text" placeholder="Description" id="Mdesc">
        </div>

        <div class="textbox">
            <i class="fas fa-weight"></i>
            <input type="text" placeholder="Weight" id="Mwt">
        </div>

        <div class="textbox">
			<i class="fas fa-archway"></i>
            <input type="text" placeholder="Manufactured by" id="Mfd_by">
        </div>
        
        <div class="textbox">
			<i class="fas fa-search-location"></i>
            <input type="text" placeholder="Manufactured in" id="Mfd_in">
        </div>

        <div class="textbox">
            <i class="fas fa-dollar-sign"></i>
            <input type="text" placeholder="Price" id="Mrate">
        </div>

        <div class="textbox">
            <i class="fas fa-tag"></i>
            <input type="text" placeholder="Batch No." id="batch">
        </div>
        
        <div class="textbox">
			<i class="fas fa-calendar-plus"></i>
            <input type="text" id="mfg" placeholder="Date Of Mfg.(mm-yyyy)">
        </div>

        <div class="textbox">
			<i class="fas fa-calendar-times"></i>
            <input type="text" placeholder="Date of Exp.(mm-yyyy)", id="exp">
        </div>

        <input type="button" class="btn" id="AddMed" value="SUBMIT">
	</div>
	
	<div class="Batch-box">
		<h1>Batch Update</h1>
		<div class="textbox">
			<i class="fas fa-barcode"></i>
			<input type="text" placeholder="Barcode" id="B_Mid">	        
		</div>

        <div class="textbox">
            <i class="fas fa-tag"></i>
            <input type="text" placeholder="Batch No." id="B_batch">
        </div>
        
        <div class="textbox">
			<i class="fas fa-calendar-plus"></i>
            <input type="text" id="B_mfg" placeholder="Date Of Mfg.(mm-yyyy)">
        </div>

        <div class="textbox">
			<i class="fas fa-calendar-times"></i>
            <input type="text" placeholder="Date of Exp.(mm-yyyy)", id="B_exp">
		</div>
		
		<input type="button" class="btn" id="U_batch" value="Update">
	</div>

    <script src="https://code.jquery.com/jquery-3.1.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.0.0-beta.34/dist/web3.min.js"></script>

    <script>
        var contract;
                $(document).ready(function(){
                web3 = new Web3(web3.currentProvider);
                var address = "0x524CE8C302DAeB02c9D8f767f7Bf3FB05Ae32EbF";
                var abi = [
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "BID",
				"type": "uint256"
			},
			{
				"internalType": "string",
				"name": "name",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "wt",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "mfg_by",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "mfg_in",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "desc",
				"type": "string"
			},
			{
				"internalType": "int256",
				"name": "rate",
				"type": "int256"
			},
			{
				"internalType": "string",
				"name": "batch",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "mfd_date",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "expire",
				"type": "string"
			}
		],
		"name": "add_new_medi",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "BID",
				"type": "uint256"
			},
			{
				"internalType": "string",
				"name": "batch",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "mfd_date",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "expire",
				"type": "string"
			}
		],
		"name": "modify_medi_batch",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "bcd",
				"type": "uint256"
			}
		],
		"name": "get_info",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			},
			{
				"internalType": "int256",
				"name": "",
				"type": "int256"
			},
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "x",
				"type": "string"
			}
		],
		"name": "test",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "pure",
		"type": "function"
	}
];
				contract = new web3.eth.Contract(abi,address);
                })

                $('#AddMed').click(function(){
                    var Medicine_id = "";
                    var Medicine_name = "";
                    var Medicine_desc = "";
                    var Medicine_weight = "";
                    var made_by = "";
                    var made_in = "";
                    var Medicine_price = "";
                    var Batch_no = "";
                    var mfg_on = "";
                    var expire_on = "";

                    Medicine_id =parseInt($("#Mid").val());
                    Medicine_name =$("#Mname").val();
                    Medicine_desc =$("#Mdesc").val();
                    Medicine_weight =$("#Mwt").val();
                    made_by =$("#Mfd_by").val();
                    made_in =$("#Mfd_in").val();
                    Medicine_price =parseInt($("#Mrate").val());
                    Batch_no =$("#batch").val();
                    mfg_on =$("#mfg").val();
                    expire_on =$("#exp").val();

                    web3.eth.getAccounts().then(function(accounts){
                        var acc = accounts[0];
                        contract.methods.add_new_medi(Medicine_id,Medicine_name,Medicine_weight,made_by,made_in,Medicine_desc,Medicine_price,Batch_no,mfg_on,expire_on).send({from: acc});
                    }).then(function(tx){
                        console.log(tx);
                    }).catch(function(tx){
                        console.log(tx);
                    })  
                })

				$('#U_batch').click(function(){
                    var Medicine_id = "";
                    var Batch_no = "";
                    var mfg_on = "";
                    var expire_on = "";

                    Medicine_id =parseInt($("#B_Mid").val());
                    Batch_no =$("#B_batch").val();
                    mfg_on =$("#B_mfg").val();
                    expire_on =$("#B_exp").val();

                    web3.eth.getAccounts().then(function(accounts){
                        var acc = accounts[0];
                        contract.methods.modify_medi_batch(Medicine_id,Batch_no,mfg_on,expire_on).send({from: acc});
						
                    }).then(function(tx){
                        console.log(tx);
                    }).catch(function(tx){
                        console.log(tx);
                    })  
                })
    </script>




</body>
</html>